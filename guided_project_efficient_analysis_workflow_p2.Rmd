---
title: 'Guided Project: Creating an Efficient Data Analysis Workflow, part 2'
author: "Mariby Cruz"
date: "2025-03-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```


The book company I'm working for launched a new program encouraging customers to buy more books on July 1st, 2019, and it wants to know if this new program was successful at increasing sales and improving review quality. 
This guided project will focus on using the packages `purrr` and `stringr`.

## Data Exploration
There are 5,000 purchases in the sales2019 dataset with information on the date the purchase was made, whether the user submitted a review, the title of the book purchased, how many books purchased, and the type of customer that made the purchase (ie. Business or Individual).   

All the columns, except for total amount purchased, are in a character or string format. This is a hint to the type of data manipulation that will take place in this project: string manipulation.  

```{r}
library(readr)
library(tibble)
library(stringr)
library(purrr)
library(dplyr)
```

```{r}
sales_df <- read.csv("~/git/DataQuest_guided_projects/sales2019.csv")
glimpse(sales_df)

```

## Handling Missing Data
```{r}
#glimpse of the data showed missing values for a column. Created a for loop to find out how many columns have NA's. Columns customer_review and total_purchased have missing data.

col_missing_counts <- c()
for (col_name in names(sales_df)) {
  #sum up the counts of NA for each column
  col_missing_counts[col_name] <- sum(is.na(sales_df[col_name]))
}
col_missing_counts
```

This guided project will handle missing data in the sense that we want to keep as much sales data as possible. So rows with missing customer reviews will be removed. For missing values in total books purchased, they will be replaced with the dataset's average (imputation). 

```{r}
#removing NA rows from customer review column
sales_no_na_df <- sales_df %>%
  filter(!is.na(user_submitted_review))
dim(sales_no_na_df) #a total of 456 rows were removed

#calculating average books purhcased to replaced NA values with
avg_books_purchased <- mean(sales_no_na_df$total_purchased, na.rm = TRUE)

#complete dataset created
sales_complete <- sales_no_na_df %>%
  mutate(
    total_purchased = if_else(is.na(total_purchased), avg_books_purchased , total_purchased)
  )
```

